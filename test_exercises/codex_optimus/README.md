## Вводная

Есть очень плохо спроектированная БД :) Для системы, позволяющей выдавать займы, учитывать суммы выдач и выплат и т.д.

Что есть займ (loan). Некоторая сумма денег(основной долг, ОД, MD), которую клиент берет в долг у организации под определенный процент (INT), и постепенно выплачивает суммы, указанные в заранее сформированном графике платежей. Часть платежа уходит на погашение ОД, часть на погашение начисленных процентов. Если человек не заплатил/заплатил не полностью сумму по  графику, то начисляется пеня (PEN), еще может начисляться комиссия (COM).

Каждая подобная операция вносится в таблицу Operations. При этом, разрабатывая эту систему, как то забыли добавить сущность счета и балансов, что сильно облегчило бы жизнь)
Поэтому баланс на каждом абстрактном “типе счета” приходится считать, как сумма всех операций.

Задача:
Написать запрос, который для каждого дня без пропусков*, начиная с минимального значения Operations.created_at, и заканчивая текущим днем, посчитает портфель (только текущий остаток по ОД), а также общую прибыль (сумма дохода от остальных типов операций) 

портфель = весь outcome по счету ОД - income по счету ОД
прибыль = income остальных типов операций

DDL:
create table Operations (
 	id number,
 	loan_id number,
 	is_income_flg char(1), -- 1/0
 	type varchar(3), -- MD/INT/PEN/COM
 	created_at date,
 	amount number(15, 2)
);

Пример:
1. 2 клиента взяли кредиты по 1000 $.
2. По графику платеж спустя 2 дня, 1 клиент внес - 100 $ (70 - ОД, 30 - проценты)
3. Результат

Дата	Портфель	Прибыль
2023-01-01	2000	0
2023-01-02	2000	0
2023-01-03	1930	30